# =============================================================================
# Maestro — Environment Configuration
# =============================================================================
# Copy to .env and customize. DO NOT COMMIT .env (it is gitignored).
#
# Required for production (minimum):
#   ACCESS_TOKEN_SECRET  - JWT signing (e.g. openssl rand -hex 32)
#   DB_PASSWORD          - Postgres password (e.g. openssl rand -hex 16)
#   CORS_ORIGINS         - JSON array of exact origins (never use "*")
#   OPENROUTER_API_KEY   - Required for LLM
#
# Supported environments:
#   Local dev:  DOMAIN=localhost, NGINX_CONF_DIR=conf.d-local, CORS below
#   Production: Set your domain and exact CORS origins (never use "*")

# -----------------------------------------------------------------------------
# Domain and API
# -----------------------------------------------------------------------------
# Local dev: set NGINX_CONF_DIR=conf.d-local so nginx doesn't load SSL config
# NGINX_CONF_DIR=conf.d-local
DOMAIN=localhost
# When false, /docs and /openapi.json are disabled (recommended for stage/production)
DEBUG=false
HOST=0.0.0.0
PORT=10001

# CORS (JSON array). Required for browser/app requests. Local dev example; production: set exact origins.
CORS_ORIGINS=["http://localhost:5173", "http://localhost:10001", "stori://"]

# -----------------------------------------------------------------------------
# Authentication (required for API access)
# -----------------------------------------------------------------------------
# Generate with: openssl rand -hex 32
ACCESS_TOKEN_SECRET=your_secret_key_here
# In-memory revocation cache TTL (seconds). Revocation visible within at most this window. Default 60.
# TOKEN_REVOCATION_CACHE_TTL_SECONDS=60

# -----------------------------------------------------------------------------
# LLM (OpenRouter)
# -----------------------------------------------------------------------------
LLM_PROVIDER=openrouter
OPENROUTER_API_KEY=sk-or-v1-xxxxxxxxxxxx
LLM_MODEL=anthropic/claude-sonnet-4.6
# OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
LLM_TIMEOUT=120
LLM_MAX_TOKENS=4096
LLM_TEMPERATURE=0.7
LLM_TOP_P=0.95

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# -----------------------------------------------------------------------------
# MUST set DB_PASSWORD in production (e.g. openssl rand -hex 16). Never use default.
# DATABASE_URL is built from DB_PASSWORD when using Docker Postgres.
DATABASE_URL=postgresql+asyncpg://maestro:REPLACE_ME@postgres:5432/maestro
DB_PASSWORD=REPLACE_ME

# -----------------------------------------------------------------------------
# Budget
# -----------------------------------------------------------------------------
DEFAULT_BUDGET_CENTS=500

# -----------------------------------------------------------------------------
# Music generation (Storpheus — runs in Docker)
# -----------------------------------------------------------------------------
# When running via docker compose, STORPHEUS_BASE_URL is overridden to the
# internal service URL. Override here only if running Maestro on the host.
STORPHEUS_BASE_URL=http://localhost:10002
# STORPHEUS_TIMEOUT=180
# STORPHEUS_SPACE=example/Orpheus-Music-Transformer  # Dedicated GPU fork
# HF_API_KEY=  # HuggingFace API key (needed for private/GPU-quota Spaces)

# -----------------------------------------------------------------------------
# RAG / Qdrant (runs in Docker)
# -----------------------------------------------------------------------------
# QDRANT_HOST=qdrant
# QDRANT_PORT=6333
# RAG embeddings use HuggingFace (HF_API_KEY) via scripts/ingest_docs.py

# -----------------------------------------------------------------------------
# AWS S3 asset delivery (drum kits, soundfont)
# -----------------------------------------------------------------------------
# Set via deploy/setup-s3-assets.sh output. Leave unset to disable.
# AWS_S3_ASSET_BUCKET=stori-assets
# AWS_REGION=eu-west-1
# Presigned URL expiry (seconds); default 1800 = 30 min
# PRESIGN_EXPIRY_SECONDS=1800
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# Optional: author/license for upload scripts
# ASSET_AUTHOR=Maestro
# ASSET_LICENSE=CC0

# -----------------------------------------------------------------------------
# Orchestration (EDITING loop; optional overrides)
# -----------------------------------------------------------------------------
# ORCHESTRATION_MAX_ITERATIONS=10
# ORCHESTRATION_TEMPERATURE=0.1

# -----------------------------------------------------------------------------
# E2E / QA scripts (scripts/e2e/)
# -----------------------------------------------------------------------------
# JWT for manual e2e tests. Generate with:
#   python scripts/generate_access_code.py --generate-user-id --hours 24 -q
# E2E_ACCESS_TOKEN=

# -----------------------------------------------------------------------------
# MCP stdio server (optional; for Cursor/Claude Desktop proxying to this backend)
# -----------------------------------------------------------------------------
# When set, stdio MCP forwards DAW tool calls to the Maestro URL with this token.
# MAESTRO_MCP_URL=http://localhost:10001
# MCP_TOKEN=

# -----------------------------------------------------------------------------
# Deploy / SSL (used by deploy scripts)
# -----------------------------------------------------------------------------
# CERTBOT_EMAIL=admin@example.com
