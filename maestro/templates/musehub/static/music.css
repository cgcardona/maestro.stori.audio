/*
 * Muse Hub Music-Specific Styles
 *
 * Visual components for music data: piano roll lanes, waveform display,
 * radar / spider charts for musical dimensions, contribution graphs,
 * and diff heatmaps.  These are purpose-built for the Muse Hub domain
 * and have no equivalent in generic UI libraries.
 *
 * Each section is self-contained — components from other sections of the
 * design system (cards, badges, layout) are composed at the page level.
 */

/* -------------------------------------------------------------------------
 * Piano roll
 * A grid of note cells arranged by pitch (rows) and time (columns).
 * --piano-roll-rows controls how many pitch lanes to show (default 12).
 * Note cells are coloured by track using var(--track-N) tokens.
 * ------------------------------------------------------------------------- */
.piano-roll {
  --piano-roll-rows: 12;
  --piano-roll-cell-h: 12px;
  --piano-roll-cell-w: 6px;
  overflow: auto;
  background: var(--bg-base);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-base);
  padding: var(--space-2);
}

.piano-roll-grid {
  display: grid;
  grid-template-rows: repeat(var(--piano-roll-rows), var(--piano-roll-cell-h));
  gap: 1px;
  min-width: max-content;
}

.piano-roll-lane {
  display: flex;
  gap: 1px;
  align-items: center;
}

/* Black-key rows get a slightly lighter background */
.piano-roll-lane.is-black {
  background: rgba(255, 255, 255, 0.03);
}

.piano-roll-note {
  height: var(--piano-roll-cell-h);
  border-radius: 2px;
  opacity: 0.85;
  min-width: var(--piano-roll-cell-w);
}

/* Note colours keyed to track tokens */
.piano-roll-note[data-track="0"] { background: var(--track-0); }
.piano-roll-note[data-track="1"] { background: var(--track-1); }
.piano-roll-note[data-track="2"] { background: var(--track-2); }
.piano-roll-note[data-track="3"] { background: var(--track-3); }
.piano-roll-note[data-track="4"] { background: var(--track-4); }
.piano-roll-note[data-track="5"] { background: var(--track-5); }
.piano-roll-note[data-track="6"] { background: var(--track-6); }
.piano-roll-note[data-track="7"] { background: var(--track-7); }

/* Pitch label column (C, D, E …) */
.piano-roll-labels {
  display: flex;
  flex-direction: column;
  gap: 1px;
  margin-right: var(--space-2);
  flex-shrink: 0;
}

.piano-roll-label {
  height: var(--piano-roll-cell-h);
  font-size: 9px;
  font-family: var(--font-mono);
  color: var(--text-muted);
  display: flex;
  align-items: center;
  width: 20px;
}

/* -------------------------------------------------------------------------
 * Waveform / audio visualisation
 * A canvas-friendly container; the actual waveform is drawn by JS.
 * ------------------------------------------------------------------------- */
.waveform {
  position: relative;
  background: var(--bg-base);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-base);
  overflow: hidden;
  height: 64px;
}

.waveform canvas {
  display: block;
  width: 100%;
  height: 100%;
}

.waveform-playhead {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 2px;
  background: var(--color-orange);
  pointer-events: none;
}

/* -------------------------------------------------------------------------
 * Radar / spider chart for musical dimensions
 * Rendered as an SVG; these classes apply to SVG elements inside
 * a <svg class="radar-chart"> element generated by JavaScript.
 * ------------------------------------------------------------------------- */
.radar-chart {
  overflow: visible;
}

.radar-axis {
  stroke: var(--border-default);
  stroke-width: 1;
}

.radar-polygon {
  fill-opacity: 0.15;
  stroke-width: 2;
}

/* Dimension-specific stroke / fill colours */
.radar-polygon-harmonic  { stroke: var(--dim-harmonic);  fill: var(--dim-harmonic); }
.radar-polygon-rhythmic  { stroke: var(--dim-rhythmic);  fill: var(--dim-rhythmic); }
.radar-polygon-melodic   { stroke: var(--dim-melodic);   fill: var(--dim-melodic); }
.radar-polygon-structural{ stroke: var(--dim-structural);fill: var(--dim-structural); }
.radar-polygon-dynamic   { stroke: var(--dim-dynamic);   fill: var(--dim-dynamic); }

.radar-label {
  fill: var(--text-muted);
  font-size: 11px;
  font-family: var(--font-sans);
}

/* -------------------------------------------------------------------------
 * Contribution heatmap
 * Modelled on the GitHub contribution calendar.
 * Used on the profile page and repo overview.
 * ------------------------------------------------------------------------- */
.contrib-graph {
  display: flex;
  gap: 2px;
  flex-wrap: nowrap;
  overflow-x: auto;
}

.contrib-week {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.contrib-day {
  width: 10px;
  height: 10px;
  border-radius: 2px;
  background: var(--bg-surface);
  border: 1px solid var(--border-subtle);
}

/* Commit intensity levels (0 = none, 4 = high) */
.contrib-day[data-count="0"] { background: var(--bg-surface); }
.contrib-day[data-count="1"] { background: #0e4429; border-color: #0e4429; }
.contrib-day[data-count="2"] { background: #006d32; border-color: #006d32; }
.contrib-day[data-count="3"] { background: #26a641; border-color: #26a641; }
.contrib-day[data-count="4"] { background: #39d353; border-color: #39d353; }

/* -------------------------------------------------------------------------
 * Diff heatmap
 * Visual summary of how much each musical dimension changed between commits.
 * Rendered as a bar/row with a colour corresponding to the dimension.
 * ------------------------------------------------------------------------- */
.diff-heatmap {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  padding: var(--space-3);
  background: var(--bg-surface);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-base);
}

.diff-dim-row {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.diff-dim-label {
  width: 90px;
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  text-transform: capitalize;
  flex-shrink: 0;
}

.diff-dim-bar-wrap {
  flex: 1;
  height: 8px;
  background: var(--bg-overlay);
  border-radius: var(--radius-full);
  overflow: hidden;
}

.diff-dim-bar {
  height: 100%;
  border-radius: var(--radius-full);
  transition: width var(--transition-slow);
}

.diff-dim-bar-harmonic  { background: var(--dim-harmonic); }
.diff-dim-bar-rhythmic  { background: var(--dim-rhythmic); }
.diff-dim-bar-melodic   { background: var(--dim-melodic); }
.diff-dim-bar-structural{ background: var(--dim-structural); }
.diff-dim-bar-dynamic   { background: var(--dim-dynamic); }

.diff-dim-value {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  font-family: var(--font-mono);
  width: 40px;
  text-align: right;
  flex-shrink: 0;
}

/* -------------------------------------------------------------------------
 * Profile page — contributor avatar + repo grid
 * (These were in the per-page _PROFILE_CSS string; moved here so the
 *  classes are available on any page that needs them.)
 * ------------------------------------------------------------------------- */
.profile-header {
  display: flex;
  align-items: flex-start;
  gap: var(--space-6);
  margin-bottom: var(--space-6);
}

.avatar {
  width: 80px;
  height: 80px;
  border-radius: var(--radius-full);
  background: var(--bg-overlay);
  border: 2px solid var(--border-default);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 32px;
  flex-shrink: 0;
}

.avatar img {
  width: 100%;
  height: 100%;
  border-radius: var(--radius-full);
  object-fit: cover;
}

.profile-meta {
  flex: 1;
}

.profile-meta h1 {
  font-size: 22px;
  color: var(--text-primary);
  margin-bottom: var(--space-1);
}

.bio {
  font-size: var(--font-size-base);
  color: var(--text-muted);
  margin-bottom: var(--space-3);
}

.repo-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: var(--space-3);
}

.repo-card {
  background: var(--bg-surface);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-base);
  padding: 14px;
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.repo-card h3 {
  font-size: 15px;
  margin: 0;
}

.repo-card .repo-meta {
  font-size: var(--font-size-sm);
  color: var(--text-muted);
}

.credits-badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  background: rgba(31, 111, 235, 0.13);
  border: 1px solid var(--color-accent-muted);
  border-radius: var(--radius-base);
  padding: var(--space-2) 14px;
  font-size: var(--font-size-base);
}

.credits-badge .num {
  font-size: 22px;
  font-weight: var(--font-weight-bold);
  color: var(--color-accent);
}

/* -------------------------------------------------------------------------
 * Responsive overrides for music components
 * ------------------------------------------------------------------------- */
@media (max-width: 479px) {
  .profile-header {
    flex-direction: column;
  }

  .piano-roll {
    --piano-roll-cell-w: 4px;
  }

  .diff-dim-label {
    width: 60px;
  }

  .repo-grid {
    grid-template-columns: 1fr;
  }
}
